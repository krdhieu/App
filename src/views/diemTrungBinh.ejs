<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        />
        <script
            defer
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        ></script>
        <!-- <script defer src="/src/showHideSideBar.js"></script> -->
        <link rel="stylesheet" href="/css/styles.css" />
        <title>Document</title>
    </head>
    <body style="background-color: #808080">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <button
                type="button"
                class="navbar-brand btn mx-2 show-hide-sidebar"
                data-bs-toggle="offcanvas"
                data-bs-target="#custom-sidebar"
            >
                <i class="fa-solid fa-bars"></i>
            </button>
            <div class="container-fluid p-0">
                <a class="navbar-brand btn" href="/home">Home</a>
            </div>
            <!-- dropdown -->
            <div
                class="btn-group me-sm-5"
                role="group"
                aria-label="Button group with nested dropdown"
            >
                <div class="btn-group me-3" role="group">
                    <button
                        id="btnGroupDrop1"
                        type="button"
                        class="btn btn-primary dropdown-toggle"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                    >
                        Account
                    </button>
                    <ul
                        class="dropdown-menu bg-dark"
                        aria-labelledby="btnGroupDrop1"
                    >
                        <li>
                            <a
                                class="dropdown-item text-white-50"
                                href="/get-change-password"
                                >Đổi mật khẩu</a
                            >
                        </li>
                        <li>
                            <a class="dropdown-item text-danger" href="/logout">
                                <i
                                    class="fa-solid fa-arrow-right-from-bracket small"
                                >
                                </i>
                                <span>Đăng xuất</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- sidebar -->
        <div class="container-fluid p-0 row sidebar-container">
            <div
                class="custom-sidebar offcanvas offcanvas-start col-2"
                id="custom-sidebar"
            >
                <div
                    class="sidebar-custom btn-group-vertical p-0"
                    style="background-color: #212529; height: 100vh"
                >
                    <a
                        href="/quanlyphongban"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Phòng Ban</a
                    >

                    <a
                        href="/quanlychucvu"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Chức Vụ</a
                    >

                    <a
                        href="/quanlychucvuhd"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Chức Vụ HĐ</a
                    >

                    <a
                        href="/quanlyxeploai"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Xếp Loại</a
                    >

                    <a
                        href="/quanlytrangthaisangkien"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Trạng Thái Sáng Kiến</a
                    >

                    <a
                        href="/quanlynhanvien/:search"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Nhân Viên</a
                    >

                    <a
                        href="/create-sangkien"
                        class="btn btn-dark btn-sm text-start"
                        >Đăng ký sáng kiến</a
                    >

                    <a
                        href="/quanlysangkien"
                        class="btn btn-dark btn-sm text-start"
                        >Duyệt Sáng Kiến
                    </a>

                    <a
                        href="/quanlydotsangkien"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Đợt Sáng Kiến</a
                    >

                    <a
                        href="/get-cham-diem"
                        class="btn btn-dark btn-sm text-start"
                        >Chấm điểm</a
                    >

                    <a href="/get-hdkh" class="btn btn-dark btn-sm text-start"
                        >Quản Lý Hội Đồng Khoa Học</a
                    >

                    <a
                        href="/manage-account"
                        class="btn btn-dark btn-sm text-start"
                        >Quản Lý Tài Khoản</a
                    >
                </div>
            </div>
        </div>
        <%if(typeof(alert)!=='undefined' && alert=='2'){%>
            <div class="alert alert-success alert-dismissible position-absolute">
                <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                ></button>
                <strong>Success!</strong> Xếp loại Sáng kiến đã được cập nhật
            </div>
            <%}%>
        <div class="container-fluid mb-0">
            <h1 class="mb-0 text-white">Xếp loại sáng kiến</h1>
        </div>

      
        <% if(typeof(alert)!=='undefined' && alert==='1'){%>
        <div>
            <h1>Không có sáng kiến cần đánh giá</h1>
        </div>
        <%} else {%>

        <div class="container-fluid mt-3 ">
            <table class="table table-dark text-center">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Mã Sáng Kiến</th>
                    <th scope="col">Tên Sáng Kiến</th>
                    <th scope="col">Điểm Trung Bình <br> Mục Đích</th>
                    <th scope="col">Điểm Trung Bình <br> Nội Dung</th>
                    <th scope="col">Điểm Trung Bình <br> Ứng Dụng</th>
                    <th scope="col">Điểm Trung Bình <br> Trình Bày</th>
                    <th scope="col">Xếp Loại</th>
                    <th scope="col" width="200px">Actions</th>
                  </tr>
                </thead>
                <tbody>
                    <% for(let i=0;i<diemSangKien.length;i++){%>
                  <tr>
                    <th scope="row"><%=i + 1%></th>
                    <td><%=diemSangKien[i].masangkien%></td>
                    <td><%=diemSangKien[i].tensangkien%></td>
                    <td><%=(diemSangKien[i].diem.tbmucdich===null? '' :  (diemSangKien[i].diem.tbmucdich.toFixed(2)))%></td>
                    <td><%=(diemSangKien[i].diem.tbnoidung===null? '' :  (diemSangKien[i].diem.tbnoidung.toFixed(2)))%></td>
                    <td><%=(diemSangKien[i].diem.tbungdung===null? '' :  (diemSangKien[i].diem.tbungdung.toFixed(2)))%></td>
                    <td><%=(diemSangKien[i].diem.tbtrinhbay===null? '':  (diemSangKien[i].diem.tbtrinhbay.toFixed(2)))%></td>
                    <td><%=(diemSangKien[i].tenxeploai===null? '':  (diemSangKien[i].tenxeploai))%></td>
                    <td>
                        <button type="button" class="btn btn-primary"  title="Xếp loại sáng kiến" data-bs-toggle="modal" data-bs-target="#sk<%=diemSangKien[i].masangkien%>"> 
                            <i class="fa-solid fa-pen"></i>
                        </button>
                        
                        <a href="/chitietdiem-xeploai-nhanxet?masangkien=<%=diemSangKien[i].masangkien%>" class="btn btn-primary"  data-bs-toggle="tooltip" title="Chi tiết điểm"> 
                            
                            <i class="fa-solid fa-file-lines"></i>
                        </a>
                    </td>
                  </tr>
                  <div class="modal" id="sk<%=diemSangKien[i].masangkien%>">
                    <div class="modal-dialog">
                      <div class="modal-content">
                  
 
                        <div class="modal-header">
                          <h4 class="modal-title">Xếp loại sáng kiến</h4>
                          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                  

                        <div class="modal-body">
                          <form action="/xep-loai-sk" method="post">
                              <div class="form-group">
                                  <label for="">Mã sáng kiến:</label>
                                <input type="text" name="maSangKien" class="form-control" value="<%=diemSangKien[i].masangkien%>" readonly> 
                              </div>
                             
                              <div class="form-group">
                                <div>
                                    Điểm trung bình: 
                                    <% if(diemSangKien[i].diem.tbmucdich!==null && diemSangKien[i].diem.tbnoidung!==null &&
                                    diemSangKien[i].diem.tbungdung!==null&&
                                    diemSangKien[i].diem.tbtrinhbay!==null) {%>
                                        <div class="fw-bold">
                                            <%= ((parseFloat(diemSangKien[i].diem.tbmucdich) +
                                             parseFloat(diemSangKien[i].diem.tbnoidung) +
                                             parseFloat(diemSangKien[i].diem.tbungdung) +
                                             parseFloat(diemSangKien[i].diem.tbtrinhbay))/4).toFixed(2) %>
                                        </div>
                                    <%}%>
                                </div>
                            </div>
                            <!-- xeploaicu -->
                            <div class="form-group" hidden>
                                <label for="">Xếp Loại Cũ</label>
                                <input type="text" name="maXepLoaiCu" class="form-control" value="<%=diemSangKien[i].maxeploai%>" readonly> 
                            </div>

                              <div class="form-group mt-2">
                                  <label for="">Loại:</label>
                                <select name="maXepLoaiMoi" class="form-control">
                                    <% for(let i=0;i<loaiXepLoai.length;i++){%>
                                        <option value="<%=loaiXepLoai[i].maxeploai%>"><%=loaiXepLoai[i].tenxeploai%> : <%=loaiXepLoai[i].motaxeploai%></option>
                                    <%}%>
                                </select>
                              </div>
                              <div class="form-group mt-2">
                                <button type="submit" class="btn btn-primary"> Save </button>
                              </div>
                          </form>
                        </div>
                  

                        <div class="modal-footer">
                          <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                        </div>
                  
                      </div>
                    </div>
                  </div>


                  <%}%>
                </tbody>
              </table>
              <%}%>
              
    </body>
</html>
